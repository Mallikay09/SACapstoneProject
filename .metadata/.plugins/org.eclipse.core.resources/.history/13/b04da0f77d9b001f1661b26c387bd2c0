package com.Module1.Login;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.testng.annotations.DataProvider;

public class ExcelUtility {
	XSSFWorkbook wb;
	@DataProvider(name="excelLoginData")
	public Object[][] excelData()
	{
		//Locate the excel file path using file class
		  File f1=new File(System.getProperty("user.dir")+"//TestData//Data.xlsx");
		  FileInputStream fs;
		  Object arr[][]=null;
		try {
			fs = new FileInputStream(f1);
			//Workbook
			  wb=new XSSFWorkbook(fs);

			  String uName1=wb.getSheet("userData").getRow(1).getCell(0).getStringCellValue();
			  System.out.println("User name: "+uName1);
			  /****************To Read Complete excel Data(Using Array)************/
			  int rows=wb.getSheet("userData").getPhysicalNumberOfRows();
			  System.out.println("No. of Rows: "+rows);
			  
			  int cells=wb.getSheet("userData").getRow(0).getPhysicalNumberOfCells();
			  
			  System.out.println("No. of Columns: "+cells);
			  
			  arr=new Object[rows-1][cells];
			  
			  for(int i=1;i<rows;i++)//to skip heading i starts with 1
			  {
				  for(int j=0;j<cells;j++)
				  {
					  arr[i-1][j]=wb.getSheet("userData").getRow(i).getCell(j).getStringCellValue();
					  System.out.print(arr[i-1][j]+"   ");
				  }
				  System.out.println();
				  
			  }    
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return arr;
	} 

}
